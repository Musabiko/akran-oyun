<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Akran Zorbalığı Oyun</title>
<style>
body { font-family: Arial; text-align:center; padding:20px; background:#f0f8ff; }
button { padding:10px 20px; margin:5px; cursor:pointer; }
textarea, select { width:80%; margin-bottom:10px; }
.quiz { display:none; border:1px solid #0077b6; padding:10px; margin:10px auto; background:#e0f7fa; }
#market { border-top:2px solid #0077b6; margin-top:20px; padding-top:10px; }
</style>
</head>
<body>

<h1>Akran Zorbalığına Karşı Oyun</h1>
<p>Puanınız: <span id="puan">0</span></p>

<h2>Ana Görevler</h2>
<div>
  <h3>Görev 1: Paragraf Yaz (Kolay - 1 Puan)</h3>
  <p>Akran zorbalığı ile ilgili kısa bir paragraf yazın:</p>
  <textarea id="gorev1-text" rows="4" placeholder="Buraya yazınız..."></textarea><br>
  <button onclick="gorevTamamla('gorev1',1,'Akran zorbalığı, öğrencilerin birbirine fiziksel, sözlü veya sosyal olarak zarar vermesidir. Önlenmelidir.')">Görevi Tamamla</button>
</div>

<h2>Mini Quizler (Opsiyonel)</h2>
<button onclick="toggleQuiz('quiz1')">Mini Quiz 1 Aç / Kapat</button>
<div id="quiz1" class="quiz">
  <p>Akran zorbalığı nedir?</p>
  <select id="gorev2-text">
    <option value="">Seçiniz</option>
    <option value="Arkadaşlara yardım etmemek">Arkadaşlara yardım etmemek</option>
    <option value="Birine kötü davranmak veya rahatsız etmek">Birine kötü davranmak veya rahatsız etmek</option>
  </select><br>
  <button onclick="gorevTamamla('gorev2',2,'Birine kötü davranmak veya rahatsız etmek')">Cevabı Gönder (+2 Puan)</button>
</div>

<button onclick="toggleQuiz('quiz2')">Mini Quiz 2 Aç / Kapat</button>
<div id="quiz2" class="quiz">
  <p>Bir arkadaşınız zorbalığa uğruyor, ne yaparsınız? Açıkça yazın:</p>
  <textarea id="gorev3-text" rows="4" placeholder="Cevabınızı yazın..."></textarea><br>
  <button onclick="gorevTamamla('gorev3',5)">Görevi Tamamla (+5 Puan)</button>
</div>

<div id="market">
<h2>Market</h2>
<p>Topladığınız puanlarla ödül alabilirsiniz:</p>
<ul>
  <li>5 Puan → Sticker</li>
  <li>10 Puan → Küçük Rozet</li>
  <li>20 Puan → Büyük Rozet</li>
  <li>50 Puan → Özel Sürpriz</li>
</ul>
</div>

<script>
let puan = 0;
let gorevTamamlandi = {};

// Yaklaşık doğru cevap kontrolü
function benzerMi(girilen, dogru) {
  girilen = girilen.toLowerCase().trim();
  dogru = dogru.toLowerCase().trim();
  const kelimelerGirilen = girilen.split(/\s+/);
  const kelimelerDogru = dogru.split(/\s+/);
  let sayac = 0;
  kelimelerGirilen.forEach(kelime => {
    if (kelimelerDogru.includes(kelime)) sayac++;
  });
  const oran = sayac / kelimelerDogru.length;
  return oran >= 0.6; // %60 benzerlik yeterli
}

function gorevTamamla(gorevId, gorevPuan, dogruCevap = null) {
  if (gorevTamamlandi[gorevId]) { 
    alert("Bu görevi zaten tamamladınız!"); 
    return; 
  }

  const textElement = document.getElementById(gorevId + "-text");
  const text = textElement.value.trim();

  // 1️⃣ Boş kontrol
  if (text === "") { 
    alert("Lütfen bir şey yazın veya cevap seçin."); 
    return; 
  }

  // 2️⃣ Minimum kelime sayısı kontrolü
  const kelimeler = text.trim().split(/\s+/);
  if (kelimeler.length < 10) {
    alert("Paragraf çok kısa! Lütfen en az 10 kelime yazın.");
    return;
  }

  // 3️⃣ Mini quiz veya yaklaşık doğru cevap kontrolü
  if (dogruCevap !== null && !benzerMi(text, dogruCevap)) {
    alert("Yanlış veya yeterince benzer değil! Lütfen daha uygun bir paragraf yazın.");
    return;
  }

  // 4️⃣ Copy-paste kontrolü
  const uniqueKelimeler = [...new Set(kelimeler)];
  const oran = kelimeler.length > 0 ? uniqueKelimeler.length / kelimeler.length : 1;
  if (oran < 0.6) {
    alert("Üzgünüm, paragraf çok benzer görünüyor. Lütfen özgün yazınız!");
    return;
  }

  // 5️⃣ Puan ekleme
  puan += gorevPuan;
  document.getElementById('puan').innerText = puan;
  alert("Tebrikler! Görev tamamlandı ve " + gorevPuan + " puan kazandınız.");
  gorevTamamlandi[gorevId] = true;
  textElement.value = "";
}

function toggleQuiz(quizId) {
  const quizDiv = document.getElementById(quizId);
  if (quizDiv.style.display === "none" || quizDiv.style.display === "") {
    quizDiv.style.display = "block";
  } else {
    quizDiv.style.display = "none";
  }
}
</script>

</body>
</html>


